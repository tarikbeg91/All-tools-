<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang-key="appTitle">рд╡рд┐рдЬрд╝реБрдЕрд▓ рд╢реАрдЯ рд▓реЗрдЖрдЙрдЯ рдХреИрд▓рдХреБрд▓реЗрдЯрд░</title>
    <!-- CSS рдХреЛ style.css рдореЗрдВ рдорд╛рдирд╛ рдЧрдпрд╛ рд╣реИ -->
    <link rel="stylesheet" href="style.css">
    <!-- html2canvas рдЕрднреА рднреА рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рд╡рд┐рдЬрд╝реБрдЕрд▓ рдбрд┐рд╕реНрдкреНрд▓реЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div id="loadingIndicator">
        <div data-lang-key="loadingPdf">PDF рдмрди рд░рд╣рд╛ рд╣реИ, рдХреГрдкрдпрд╛ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ...</div>
    </div>
    <header class="app-header">
        <div class="title" data-lang-key="headerTitle">рд╢реАрдЯ рд▓реЗрдЖрдЙрдЯ</div>
        <div class="header-icons">
            <button id="manageProjectsIcon" title="рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореИрдиреЗрдЬ рдХрд░реЗрдВ / Manage Projects">ЁЯЧВя╕П</button>
            <button id="showOffcutsLibraryIcon" title="рдСрдлрдХрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА / Offcut Library">ЁЯзй</button>
            <button id="unitSettingsIcon" title="рдпреВрдирд┐рдЯ рдмрджрд▓реЗрдВ / Change Unit">ЁЯУП</button>
            <button id="langToggle" title="рднрд╛рд╖рд╛ рдмрджрд▓реЗрдВ / Change Language">ЁЯМР</button>
            <button id="printToPdfButton" title="PDF рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ / Print as PDF">ЁЯУД <small data-lang-key="printPdfBtn">рдкреНрд░рд┐рдВрдЯ/PDF</small></button>
            <button id="sheetSettingsIcon" title="рд╢реАрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕">тЪЩя╕П</button>
            <button id="historyIcon" title="рд╣рд┐рд╕реНрдЯреНрд░реА">ЁЯУЬ</button>
            <button id="jsonIcon" title="JSON рдСрдкрд░реЗрд╢рдиреНрд╕">ЁЯТ╛</button>
        </div>
    </header>
    <div id="jsonMenu">
        <a href="#" id="exportJsonLink" data-lang-key="exportJson">JSON рдПрдХреНрд╕рдкреЛрд░реНрдЯ рдХрд░реЗрдВ</a>
        <label for="importJsonInputHidden" class="json-menu-item" data-lang-key="importJson">JSON рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░реЗрдВ</label>
        <input type="file" id="importJsonInputHidden" accept=".json" style="display: none;">
        <a href="#" id="clearSavedDataLink" data-lang-key="clearSavedData">рд╕реЗрд╡ рдбреЗрдЯрд╛ рдХреНрд▓рд┐рдпрд░ рдХрд░реЗрдВ</a>
    </div>

    <div class="container">
        <div class="parts-group">
            <h2 data-lang-key="addPieceTitle">рдкреАрд╕ рдЬреЛрдбрд╝реЗрдВ</h2>
            <label for="partName" data-lang-key="pieceNameLabel">рдкреАрд╕ рдХрд╛ рдирд╛рдо (рд╡реИрдХрд▓реНрдкрд┐рдХ):</label>
            <input type="text" id="partName" data-lang-placeholder="pieceDefaultName">
            <label for="partWidth"><span data-lang-key="pieceWidthLabel">рдкреАрд╕ рдХреА рдЪреМрдбрд╝рд╛рдИ</span> (<span class="unit-display">cm</span>):</label>
            <input type="number" id="partWidth" placeholder="0" step="any">
            <label for="partLength"><span data-lang-key="pieceLengthLabel">рдкреАрд╕ рдХреА рд▓рдВрдмрд╛рдИ (рдЧреНрд░реЗрди)</span> (<span class="unit-display">cm</span>):</label>
            <input type="number" id="partLength" placeholder="0" step="any">
            <label for="partQuantity" data-lang-key="pieceQuantityLabel">рдХрд┐рддрдиреЗ рдкреАрд╕:</label>
            <input type="number" id="partQuantity" min="1" placeholder="1">
            <button id="addPieceButton" data-lang-key="addPieceBtn">рдкреАрд╕ рдЬреЛрдбрд╝реЗрдВ</button>
        </div>

        <div class="input-group" id="addedPiecesSection">
            <h2 data-lang-key="addedPiecesTitle">рдЬреЛрдбрд╝реЗ рдЧрдП рдкреАрд╕</h2>
            <table id="piecesTable">
                <thead>
                    <tr>
                        <th data-lang-key="tableName">рдирд╛рдо</th>
                        <th><span data-lang-key="tableWidth">рдЪреМрдбрд╝рд╛рдИ</span> (<span class="unit-display">cm</span>)</th>
                        <th><span data-lang-key="tableLength">рд▓рдВрдмрд╛рдИ</span> (<span class="unit-display">cm</span>)</th>
                        <th data-lang-key="tableQuantity">рд╕рдВрдЦреНрдпрд╛</th>
                        <th class="no-print" data-lang-key="tableRemove">рд╣рдЯрд╛рдПрдВ</th>
                    </tr>
                </thead>
                <tbody></tbody>
                <tfoot>
                    <tr id="piecesTableSummaryRow" class="table-summary-row" style="display: none;">
                        <td colspan="3" data-lang-key="totalPiecesInList">рдХреБрд▓ рдкреАрд╕ рд▓рд┐рд╕реНрдЯ рдореЗрдВ:</td>
                        <td id="totalPiecesInListCount">0</td>
                        <td class="no-print"></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <div class="fitting-strategy-group">
            <label for="fittingStrategySelector" data-lang-key="fittingStrategyLabel">рдлрд┐рдЯрд┐рдВрдЧ рд░рдгрдиреАрддрд┐ рдЪреБрдиреЗрдВ:</label>
            <select id="fittingStrategySelector">
                <option value="defaultScore" data-lang-key="strategyDefaultScore">рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реНрдХреЛрд░ рдЖрдзрд╛рд░рд┐рдд (рдмрдбрд╝реЗ рдкреАрд╕ рдкрд╣рд▓реЗ)</option>
                <option value="minWastageArea" data-lang-key="strategyMinWastage">рдиреНрдпреВрдирддрдо рд╡реНрдпрд░реНрде рдХреНрд╖реЗрддреНрд░</option>
                <option value="firstFit" data-lang-key="strategyFirstFit">рдлрд░реНрд╕реНрдЯ рдлрд┐рдЯ (рд╕рдмрд╕реЗ рддреЗрдЬрд╝)</option>
                <option value="worstFit" data-lang-key="strategyWorstFit">рд╡рд░реНрд╕реНрдЯ рдлрд┐рдЯ (рдЕрдзрд┐рдХ рд╡реНрдпрд░реНрде рдХреНрд╖реЗрддреНрд░)</option>
                <option value="bottomLeftFreeRect" data-lang-key="strategyBottomLeftFree">рдЦрд╛рд▓реА рдЖрдпрдд (рдмреЙрдЯрдо-рд▓реЗрдлреНрдЯ рдкреНрд░рд╛рдердорд┐рдХрддрд╛)</option>
                <option value="sortPiecesByPerimeterDesc" data-lang-key="strategySortPiecePerimeterDesc">рдкреАрд╕: рдкрд░рд┐рдзрд┐ (рдмрдбрд╝реЗ рдкрд╣рд▓реЗ)</option>
                <option value="sortPiecesByLongestSideDesc" data-lang-key="strategySortPieceLongestSideDesc">рдкреАрд╕: рд╕рдмрд╕реЗ рд▓рдВрдмреА рднреБрдЬрд╛ рдкрд╣рд▓реЗ</option>
                <option value="sortPiecesByShortestSideAsc" data-lang-key="strategySortPieceShortestSideAsc">рдкреАрд╕: рд╕рдмрд╕реЗ рдЫреЛрдЯреА рднреБрдЬрд╛ рдкрд╣рд▓реЗ</option>
                <option value="sortPiecesByWidthDesc" data-lang-key="strategySortPieceWidthDesc">рдкреАрд╕: рдЪреМрдбрд╝рд╛рдИ (рдмрдбрд╝реЗ рдкрд╣рд▓реЗ)</option>
                <option value="sortPiecesByHeightDesc" data-lang-key="strategySortPieceHeightDesc">рдкреАрд╕: рдКрдВрдЪрд╛рдИ/рд▓рдВрдмрд╛рдИ (рдмрдбрд╝реЗ рдкрд╣рд▓реЗ)</option>
                <option value="sortPiecesByAreaAsc" data-lang-key="strategySortPieceAreaAsc">рдкреАрд╕: рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдЫреЛрдЯреЗ рдкрд╣рд▓реЗ)</option>
            </select>
             <div style="margin-top: 10px;">
                <input type="checkbox" id="useOffcutsCheckbox" style="margin-right: 5px;">
                <label for="useOffcutsCheckbox" data-lang-key="useSavedOffcutsLabel" style="display:inline-block; font-weight:normal;">рд╕рд╣реЗрдЬреЗ рдЧрдП рдСрдлрдХрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ</label>
            </div>
            <button id="calculateWithStrategyButton" data-lang-key="calculateWithStrategyBtn" style="margin-top:10px;">рдЪрдпрдирд┐рдд рд░рдгрдиреАрддрд┐ рд╕реЗ рдЧрдгрдирд╛ рдХрд░реЗрдВ</button>
        </div>


        <div class="actions-div" id="mainActionButtons">
            <button id="calculateLayoutDefaultButton" data-lang-key="calculateLayoutBtn">рд▓реЗрдЖрдЙрдЯ рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ)</button>
            <button id="resetButton" data-lang-key="resetCurrentBtn">рд░реАрд╕реЗрдЯ (рд╡рд░реНрддрдорд╛рди)</button>
        </div>

        <div class="results-group">
            <h2 data-lang-key="resultsTitle">рдкрд░рд┐рдгрд╛рдо</h2>
            <div class="results-summary" id="resultsSummary" data-lang-key="totalSheetsDefault">рдХреБрд▓ рдЖрд╡рд╢реНрдпрдХ рд╢реАрдЯреНрд╕: 0</div>
            <div class="sheets-container" id="sheetsContainer">
            </div>
            <div class="wastage-section" id="wastageSection" style="display:none;">
                 <h3 data-lang-key="wastageReportTitle">рд╡реЗрд╕реНрдЯреЗрдЬ рд░рд┐рдкреЛрд░реНрдЯ</h3>
                 <ul id="wastageOverallStats" style="list-style-type: none; padding-left: 0; margin-top:0;"></ul>
                 <hr style="margin: 10px 0; border-color: #eee;">
                 <div class="useful-offcuts-summary" id="usefulOffcutsSummary" style="display:none; margin-bottom: 5px;"></div>
                 <div class="wastage-list" id="usefulOffcutsDisplayListContainer" style="max-height: 150px; overflow-y:auto; border: 1px solid #eee; padding:5px; margin-bottom:10px;">
                 </div>
                 <div id="otherSmallWastageContainer">
                 </div>
                 <div class="wastage-list-summary" id="totalWastagePiecesSummary" style="display:none; margin-top:10px;"></div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="unitSettingsModal" class="modal">
        <div class="unit-modal-content">
            <span class="close-button" id="closeUnitSettingsModalBtn">├Ч</span>
            <h2 data-lang-key="unitSettingsTitle">рдпреВрдирд┐рдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕</h2>
            <label for="currentUnitSelector" data-lang-key="selectUnitLabel">рд╡рд░реНрддрдорд╛рди рдпреВрдирд┐рдЯ рдЪреБрдиреЗрдВ:</label>
            <select id="currentUnitSelector">
                <option value="cm">рд╕реЗрдВрдЯреАрдореАрдЯрд░ (cm)</option>
                <option value="mm">рдорд┐рд▓реАрдореАрдЯрд░ (mm)</option>
                <option value="m">рдореАрдЯрд░ (m)</option>
                <option value="ft">рдлреБрдЯ (ft)</option>
                <option value="in">рдЗрдВрдЪ (in)</option>
            </select>
            <button id="applyUnitChangeButton" style="width:100%;" data-lang-key="applyBtn">рд▓рд╛рдЧреВ рдХрд░реЗрдВ</button>
        </div>
    </div>

    <div id="sheetSettingsModal" class="modal">
        <div class="sheet-size-modal-content">
            <span class="close-button" id="closeSheetSettingsModalBtn">├Ч</span>
            <h2 data-lang-key="sheetSettingsTitle">рд╢реАрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕</h2>
            <label for="modalSheetName" data-lang-key="sheetNameLabel">рд╢реАрдЯ рдХрд╛ рдирд╛рдо (рд╡реИрдХрд▓реНрдкрд┐рдХ):</label>
            <input type="text" id="modalSheetName" data-lang-placeholder="sheetNamePlaceholder" style="margin-bottom: 15px;">
            <label for="modalSheetWidth"><span data-lang-key="sheetWidthLabel">рд╢реАрдЯ рдХреА рдЪреМрдбрд╝рд╛рдИ</span> (<span class="unit-display">cm</span>):</label>
            <input type="number" id="modalSheetWidth" value="122" step="any">
            <label for="modalSheetLength"><span data-lang-key="sheetLengthGrainLabel">рд╢реАрдЯ рдХреА рд▓рдВрдмрд╛рдИ (рдЧреНрд░реЗрди)</span> (<span class="unit-display">cm</span>):</label>
            <input type="number" id="modalSheetLength" value="244" step="any">
            <div>
                <input type="checkbox" id="modalHasGrainDirection" checked>
                <label for="modalHasGrainDirection" style="display: inline-block; margin-bottom: 0; font-weight:normal;" data-lang-key="respectGrainLabel">рдЧреНрд░реЗрди рдХреА рджрд┐рд╢рд╛ рдХрд╛ рдзреНрдпрд╛рди рд░рдЦреЗрдВ</label>
            </div>
            <div style="margin-top:15px;">
                <label for="modalGrainColor" data-lang-key="grainColorLabel">рдЧреНрд░реЗрди рдХрд╛ рд░рдВрдЧ:</label>
                <select id="modalGrainColor">
                    <option value="rgba(0,0,0,0.08)" data-lang-key="grainGray">рд╣рд▓реНрдХрд╛ рдЧреНрд░реЗ</option>
                    <option value="rgba(160,82,45,0.1)" data-lang-key="grainLightBrown">рд╣рд▓реНрдХрд╛ рднреВрд░рд╛</option>
                    <option value="rgba(139,69,19,0.1)" data-lang-key="grainDarkBrown">рдЧрд╣рд░рд╛ рднреВрд░рд╛</option>
                    <option value="rgba(210,180,140,0.1)" data-lang-key="grainTan">рдЯреИрди</option>
                    <option value="none" data-lang-key="grainNone">рдХреЛрдИ рдЧреНрд░реЗрди рдирд╣реАрдВ</option>
                </select>
            </div>
            <div class="offcut-settings-group" style="margin-top:15px; padding: 10px 0 0 0; border:none; background:none;">
                <h4 data-lang-key="offcutSettingsTitle" style="margin-bottom:5px; font-size:1em;">рдСрдлрдХрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕</h4>
                <label for="minOffcutWidth" data-lang-key="minOffcutWidthLabel">рдиреНрдпреВрдирддрдо рдСрдлрдХрдЯ рдЪреМрдбрд╝рд╛рдИ (<span class="unit-display">cm</span>):</label>
                <input type="number" id="minOffcutWidth" value="10" step="any">
                <label for="minOffcutLength" data-lang-key="minOffcutLengthLabel">рдиреНрдпреВрдирддрдо рдСрдлрдХрдЯ рд▓рдВрдмрд╛рдИ (<span class="unit-display">cm</span>):</label>
                <input type="number" id="minOffcutLength" value="45" step="any">
            </div>
            <button id="applySheetSettingsButton" style="margin-top: 15px; width:100%;" data-lang-key="applyAndSaveBtn">рд▓рд╛рдЧреВ рдХрд░реЗрдВ рдФрд░ рд╕реЗрд╡ рдХрд░реЗрдВ</button>
        </div>
    </div>

    <div id="historyModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeHistoryModalBtn">├Ч</span>
            <h2 data-lang-key="historyTitle">рд╣рд┐рд╕реНрдЯреНрд░реА</h2>
            <ul id="historyList"></ul>
            <p><small data-lang-key="historyNote">рдиреЛрдЯ: рдпрд╣ рдХреЗрд╡рд▓ рдкрд┐рдЫрд▓реЗ рдХреБрдЫ рдмрджрд▓рд╛рд╡реЛрдВ рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИред рдХрд┐рд╕реА рдЖрдЗрдЯрдо рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдЙрд╕реЗ рд▓реЛрдб рдХрд░реЗрдВред</small></p>
        </div>
    </div>

    <div id="projectManagementModal" class="modal">
        <div class="project-modal-content">
            <span class="close-button" id="closeProjectManagementModalBtn">├Ч</span>
            <h2 data-lang-key="projectManagementTitle">рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореИрдиреЗрдЬрдореЗрдВрдЯ</h2>
            <div class="projects-group">
                <h3 data-lang-key="saveCurrentProjectTitle">рд╡рд░реНрддрдорд╛рди рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗрд╡ рдХрд░реЗрдВ</h3>
                <label for="projectNameInput" data-lang-key="projectNameLabel">рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рдирд╛рдо:</label>
                <input type="text" id="projectNameInput" data-lang-placeholder="projectNamePlaceholder">
                <button id="saveCurrentProjectButton" data-lang-key="saveProjectBtn">рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗрд╡ рдХрд░реЗрдВ</button>
            </div>
            <div class="projects-group">
                <h3 data-lang-key="savedProjectsTitle">рд╕реЗрд╡ рдХрд┐рдП рдЧрдП рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕</h3>
                <ul id="projectList"></ul>
                <p id="noProjectsMessage" style="display:none;" data-lang-key="noProjectsSaved">рдХреЛрдИ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗрд╡ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</p>
            </div>
        </div>
    </div>

    <div id="offcutsLibraryModal" class="modal">
        <div class="offcuts-library-modal-content">
            <span class="close-button" id="closeOffcutsLibraryModalBtn">├Ч</span>
            <h2 data-lang-key="offcutsLibraryTitle">рдСрдлрдХрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА</h2>
            <div class="offcut-add-manual-group" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 5px; margin-bottom: 15px;">
                <h4 data-lang-key="addManualOffcutTitle" style="margin-top:0; margin-bottom:10px;">рдореИрдиреНрдпреБрдЕрд▓ рдСрдлрдХрдЯ рдЬреЛрдбрд╝реЗрдВ</h4>
                <div style="display:flex; gap:10px; align-items: flex-end;">
                    <div style="flex-grow:1;">
                        <label for="manualOffcutWidth"><span data-lang-key="offcutWidthLabel">рдЪреМрдбрд╝рд╛рдИ</span> (<span class="unit-display">cm</span>):</label>
                        <input type="number" id="manualOffcutWidth" placeholder="0" step="any" style="margin-bottom:5px;">
                    </div>
                    <div style="flex-grow:1;">
                        <label for="manualOffcutLength"><span data-lang-key="offcutLengthLabel">рд▓рдВрдмрд╛рдИ</span> (<span class="unit-display">cm</span>):</label>
                        <input type="number" id="manualOffcutLength" placeholder="0" step="any" style="margin-bottom:5px;">
                    </div>
                    <div style="flex-grow:1;">
                        <label for="manualOffcutSourceName" data-lang-key="offcutSourceNameLabel">рд╕реНрд░реЛрдд (рд╡реИрдХрд▓реНрдкрд┐рдХ):</label>
                        <input type="text" id="manualOffcutSourceName" data-lang-placeholder="offcutSourcePlaceholder" style="margin-bottom:5px;">
                    </div>
                    <button id="addManualOffcutButton" data-lang-key="addManualOffcutBtn" style="padding: 10px 15px; height: 40px; margin-bottom:5px;">рдЬреЛрдбрд╝реЗрдВ</button>
                </div>
            </div>
            <hr style="margin: 15px 0;">
            <div id="offcutsListContainer">
            </div>
            <p id="noOffcutsMessageModal" style="display:none;"></p>
        </div>
    </div>

    <!-- рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдпрд╣рд╛рдБ рд▓реЛрдб рдХрд░реЗрдВ -->
    <script type="module" src="js/main.js"></script> 
</body>
</html>
